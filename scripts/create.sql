CREATE DATABASE IF NOT EXISTS SAMA_CONCILIA;

-- -----------------------------------------------------
-- Tabla tb_facturas
-- -----------------------------------------------------
CREATE TABLE SAMA_CONCILIA.tb_factura (
    `FECHA_DE_AUDITOR√çA` DATE NOT NULL,
    `DOCUMENTO` CHAR(40) NOT NULL,
    `CONSECUTIVO` INT NOT NULL,
    `NUM_FACTURA_MEDICAMENTO` INT NOT NULL,
    `NUM_FACTURA_OL` INT NOT NULL,
    `ESM_FACTURACION` INT NOT NULL,
    `ESM_FACTURACION_NOMBRE` CHAR(125) NOT NULL,
    `ESM_CODIGO` INT NOT NULL,
    `ESM_INTERNO` INT NOT NULL,
    `ESM_NOMBRE` CHAR(125) NOT NULL,
    `ESM_ADSCRITO` INT NOT NULL,
    `ESM_ADSCRITO_NOMBRE` CHAR(125) NOT NULL,
    `FUERZA_ESM_ADSCRITO` INT NOT NULL,
    `FUERZA_ESM_NOMBRE_ADSCRITO` CHAR(125) NOT NULL,
    `FUERZA_ESM` INT NOT NULL,
    `FUERZA_ESM_NOMBRE` CHAR(125) NOT NULL,
    `TIPO_DISPENSACION` CHAR(125) NOT NULL,
    `CODIGO_AUTORIZACION` CHAR(125) NOT NULL,
    `DOCUMENTO_FECHA_FORMULACION` DATE NOT NULL,
    `DOCUMENTO_FECHA_TRANSACCION` DATE NOT NULL,
    `TIPO_MEDICAMENTO_NOMBRE` CHAR(50) NOT NULL,
    `TIPO_FORMULA_NOMBRE` CHAR(50) NOT NULL,
    `AFILIADO_CODIGO` INT(12) NOT NULL,
    `AFILIADO_NOMBRE` CHAR(125) NOT NULL,
    `FUERZA_FACTURA_NOMBRE` CHAR(125) NOT NULL,
    `TIPO_VINCULACION_NOMBRE` CHAR(50) NOT NULL,
    `CODIGO_MEDICAMENTO` CHAR(50) NOT NULL,
    `CODIGO_MEDICAMENTO_HOMIC` CHAR(50) NOT NULL,
    `DESC_MEDICAMENTO_REFERENCIA` CHAR(125) NOT NULL,
    `DESC_MEDICAMENTO_GENERICO` CHAR(125) NOT NULL,
    `F039_CANTIDAD_PEDIDA` INT NOT NULL,
    `CANTIDAD_DESPACHADA` INT NOT NULL,
    `PRECIO_UNITARIO` FLOAT NOT NULL,
    `VALOR_ADECUACION` FLOAT NOT NULL,
    `SUBTOTAL_ANTES_IVA` FLOAT NOT NULL,
    `VALOR_EXCLUIDO` FLOAT NOT NULL,
    `VALOR_GRAVADO` FLOAT NOT NULL,
    `VALOR_IVA` FLOAT NOT NULL,
    `VALOR_FACTURA_MEDICAMENTOS` FLOAT NOT NULL,
    `VALOR_INTERMEDIACION` FLOAT NOT NULL,
    `VALOR_IVA_INTERM` FLOAT NOT NULL,
    `VALOR_FACTURA_OL` FLOAT NOT NULL,
    `TOTAL` FLOAT NOT NULL,
    `TOTAL REPORTADO A SAMA` FLOAT NOT NULL,
    `DIFERENCIA ENTRE SAMA Y DROSERVICIO` FLOAT NOT NULL,
    `LOTE` CHAR(50) NOT NULL,
    `FECHA_VENCIMIENTO` DATE NOT NULL,
    `INVIMA` CHAR(50) NOT NULL,
    `DOSIS` FLOAT NOT NULL,
    `TIEMPO_DOSIS` FLOAT NOT NULL,
    `CONCENTRACION` CHAR(15) NOT NULL,
    `ESM_GENERA_FORMULA` INT NOT NULL,
    `ESM_GENERA_FORMULA_NOMBRE` CHAR(125) NOT NULL,
    `CIE10` CHAR(50) NOT NULL,
    `CIE10_NOMBRE` CHAR(50) NOT NULL,
    `MEDICO_CODIGO` INT NOT NULL,
    `MEDICO_NOMBRE` CHAR(125) NOT NULL,
    `TIPO_FORMULA` CHAR(125) NOT NULL,
    `TIRILLA` INT NOT NULL,
    `DOCUMENTO_NUMERO_ITEM` INT NOT NULL,
    `LABORATORIO_CODIGO` INT NOT NULL,
    `LABORATORIO_NOMBRE` CHAR(125) NOT NULL,
    `VR_FACTURACION` FLOAT NOT NULL,
    `ANTICIPO_50` FLOAT NOT NULL,
    `SEGUNDO_DESEMBOLSO` FLOAT NOT NULL,
    `PAGO_CONCILIACION_1` FLOAT NULL,
    `PAGO_CONCILIACION_2` FLOAT NULL,
    `SALDO` FLOAT NOT NULL,
    PRIMARY KEY (`DOCUMENTO`)
)

-- -----------------------------------------------------
-- Tabla tb_glosa
-- -----------------------------------------------------
CREATE TABLE SAMA_CONCILIA.tb_glosa(
    `ID` INT NOT NULL AUTO_INCREMENT,
    `CODIGO_GLOSA` CHAR(50) NOT NULL,
    `DESCRIPCION_GLOSA` TEXT NULL,
    `VR_MEDICAMENTO` FLOAT NULL,
    `INTERMEDIACION` FLOAT NULL,
    `IVA_INTERMEDIACION` FLOAT NULL,
    `IVA` FLOAT NULL,
    `UNIDOSIS` FLOAT NULL,
    `TOTAL` FLOAT NULL,
    `VALOR_A_PAGAR` FLOAT NULL,
    `ESTADO` CHAR(15) NULL,
    PRIMARY KEY (`ID`)
)

-- -----------------------------------------------------
-- Tabla tb_respuesta_opl
-- -----------------------------------------------------
CREATE TABLE SAMA_CONCILIA.tb_respuesta_opl(
    `RESPUESTA_OPL_ID` INT NOT NULL AUTO_INCREMENT,
    `CODIGO_GLOSA` INT NOT NULL,
    `RESPUESTA_OPL` TEXT NOT NULL,
    `OBSERVACION` TEXT NULL,
    `VALOR_ACEPTADO` FLOAT NOT NULL,
    `VALOR_NO_ACEPTADO` FLOAT NOT NULL,
    PRIMARY KEY (`RESPUESTA_OPL_ID`),
    FOREIGN KEY (`CODIGO_GLOSA`) REFERENCES SAMA_CONCILIA.tb_glosa(`ID`)
)

CREATE TABLE SAMA_CONCILIA.tb_CONCILIACION(
    `CONCILIACION_ID` INT NOT NULL AUTO_INCREMENT,
    `CODIGO_GLOSA` INT NOT NULL,
    `RESPUESTA OPL` TEXT NOT NULL,
    `OBSERVACION` TEXT NULL,
    `VALOR_ACEPTADO` FLOAT NOT NULL,
    `VALOR_NO_ACEPTADO` FLOAT NOT NULL,
    `CODIGO_GLOSA` CHAR(50) NOT NULL,
    `VALOR_OBJETADO` FLOAT NOT NULL,
    `OBSERVACION_GLOSA` TEXT NULL,
    `VALOR_OBJETADO_ACEPTADO_CONCILIACION` FLOAT NOT NULL,
    `OBSERVACION_GLOSA` TEXT NULL,
    `VALOR_SOPORTADO` FLOAT NULL,
    `OBSERVACION_GLOSA_SOPORTADA_SAMA` TEXT NULL,
    `VALOR_RATIFICADO_EN_CONCILIACION` FLOAT NULL,
    `OBSERVACION_GLOSA_DEFINITIVA` TEXT NULL,
    `VALOR_NO_CONCILIADO_SEGUNDA_INSTANCIA` FLOAT NULL,
    `OBSERVACION_GLOSA_SEGUNDA_INSTANCIA` TEXT NULL,
    `VALOR_SUBTOTAL_MEDICAMENTO_A_PAGAR` FLOAT NULL,
    `VALOR_GASTO_DE_OPL_A_PAGAR` FLOAT NULL,
    `VALOR_IVA_OPL_A_PAGAR` FLOAT NULL,
    `VALOR_IVA_DEL_MEDICAMENTO_A_PAGAR` FLOAT NULL,
    `VALOR_ADECUACION_A_PAGAR` FLOAT NULL,
    `VALOR_A_PAGAR_CONCILIADO` FLOAT NULL,
    `ESTADO` CHAR(50) NOT NULL,
    PRIMARY KEY (`CONCILIACION_ID`),
    FOREIGN KEY (`CODIGO_GLOSA`) REFERENCES SAMA_CONCILIA.tb_glosa(`ID`)
)